<script>
var Grabber = {};
Grabber.mapObject = (obj, fn) => {
    const ret = {};
    for (const k in obj) {
        ret[k] = fn(obj[k]);
    }
    return ret;
}
Grabber.typedXML = (val) => {
    if (val && typeof val === "object" && ("#text" in val || "@attributes" in val)) {
        const txt = val["#text"];

        const isNil = "@attributes" in val && "nil" in val["@attributes"] && val["@attributes"]["nil"] === "true";
        if (isNil) {
            return null;
        }

        const type = "@attributes" in val && "type" in val["@attributes"] ? val["@attributes"]["type"] : undefined;
        if (type === "integer") {
            return parseInt(txt, 10);
        } else if (type === "array") {
            delete val["@attributes"]["type"];
            if (Object.keys(val["@attributes"]).length === 0) {
                delete val["@attributes"];
            }
            return Grabber.mapObject(val, Grabber.typedXML);
        }

        if (txt !== undefined) {
            return txt;
        }
    }

    if (val && val instanceof Array) {
        return val.map(Grabber.typedXML);
    }

    if (val && typeof val === "object") {
        return Grabber.mapObject(val, Grabber.typedXML);
    }

    return val;
};


var data = {
    "xml": {},
    "tags": {
        "@attributes": {
            "type": "array"
        },
        "tag": [{
            "@attributes": {
                "type": "3",
                "count": "265",
                "name": "rumble_roses",
                "ambiguous": "false",
                "id": "103"
            }
        }, {
            "@attributes": {
                "type": "4",
                "count": "634",
                "name": "kikuchi_makoto",
                "ambiguous": "false",
                "id": "1740"
            }
        }, {
            "@attributes": {
                "type": "4",
                "count": "27",
                "name": "lunamaria_hawke",
                "ambiguous": "false",
                "id": "631"
            }
        }, {
            "@attributes": {
                "type": "5",
                "count": "286",
                "name": "okubo_mariko",
                "ambiguous": "false",
                "id": "6375"
            }
        }, {
            "@attributes": {
                "type": "0",
                "count": "1",
                "name": "fishy_sashimi",
                "ambiguous": "false",
                "id": "15867"
            }
        }, {
            "@attributes": {
                "type": "5",
                "count": "67",
                "name": "nakamura_sherii",
                "ambiguous": "false",
                "id": "14135"
            }
        }, {
            "@attributes": {
                "type": "0",
                "count": "23",
                "name": "crotchless",
                "ambiguous": "false",
                "id": "17019"
            }
        }, {
            "@attributes": {
                "type": "6",
                "count": "125",
                "name": "sister_of_the_world",
                "ambiguous": "false",
                "id": "19348"
            }
        }, {
            "@attributes": {
                "type": "6",
                "count": "20",
                "name": "not_guilty",
                "ambiguous": "false",
                "id": "4350"
            }
        }, {
            "@attributes": {
                "type": "6",
                "count": "125",
                "name": "wpb_130",
                "ambiguous": "false",
                "id": "13449"
            }
        }, {
            "@attributes": {
                "type": "3",
                "count": "60",
                "name": "just_be_friends_(vocaloid)",
                "ambiguous": "false",
                "id": "8098"
            }
        }, {
            "@attributes": {
                "type": "4",
                "count": "33",
                "name": "ichinose_kotomi",
                "ambiguous": "false",
                "id": "5715"
            }
        }, {
            "@attributes": {
                "type": "5",
                "count": "58",
                "name": "seo_you-jin",
                "ambiguous": "false",
                "id": "6280"
            }
        }, {
            "@attributes": {
                "type": "5",
                "count": "1179",
                "name": "tsugihara_kana",
                "ambiguous": "false",
                "id": "3380"
            }
        }, {
            "@attributes": {
                "type": "5",
                "count": "309",
                "name": "onozeki_mai",
                "ambiguous": "false",
                "id": "18858"
            }
        }, {
            "@attributes": {
                "type": "5",
                "count": "13",
                "name": "sonosaki_eruzu",
                "ambiguous": "false",
                "id": "12112"
            }
        }, {
            "@attributes": {
                "type": "4",
                "count": "20",
                "name": "chocola_(sayori)",
                "ambiguous": "false",
                "id": "19422"
            }
        }, {
            "@attributes": {
                "type": "5",
                "count": "320",
                "name": "sakurano_mio",
                "ambiguous": "false",
                "id": "19961"
            }
        }, {
            "@attributes": {
                "type": "6",
                "count": "29",
                "name": "tying_art_105",
                "ambiguous": "false",
                "id": "13513"
            }
        }, {
            "@attributes": {
                "type": "6",
                "count": "46",
                "name": "beautyleg_639",
                "ambiguous": "false",
                "id": "17223"
            }
        }, {
            "@attributes": {
                "type": "4",
                "count": "22",
                "name": "ver_cheer_rock_shooter",
                "ambiguous": "false",
                "id": "14754"
            }
        }, {
            "@attributes": {
                "type": "5",
                "count": "16",
                "name": "noz",
                "ambiguous": "false",
                "id": "19743"
            }
        }, {
            "@attributes": {
                "type": "0",
                "count": "1",
                "name": "beacch",
                "ambiguous": "false",
                "id": "17786"
            }
        }, {
            "@attributes": {
                "type": "5",
                "count": "10",
                "name": "yuuki_(vii)",
                "ambiguous": "false",
                "id": "16997"
            }
        }, {
            "@attributes": {
                "type": "6",
                "count": "99",
                "name": "dgc_0819",
                "ambiguous": "false",
                "id": "9258"
            }
        }, {
            "@attributes": {
                "type": "5",
                "count": "138",
                "name": "sakuragi_chikako",
                "ambiguous": "false",
                "id": "6066"
            }
        }, {
            "@attributes": {
                "type": "5",
                "count": "99",
                "name": "nakama_yukie",
                "ambiguous": "false",
                "id": "1850"
            }
        }, {
            "@attributes": {
                "type": "4",
                "count": "12",
                "name": "cure_beat",
                "ambiguous": "false",
                "id": "11746"
            }
        }, {
            "@attributes": {
                "type": "5",
                "count": "33",
                "name": "nozomi",
                "ambiguous": "false",
                "id": "9002"
            }
        }, {
            "@attributes": {
                "type": "4",
                "count": "23",
                "name": "sakamoto_mio",
                "ambiguous": "false",
                "id": "17171"
            }
        }, {
            "@attributes": {
                "type": "0",
                "count": "676",
                "name": "grey_eyes",
                "ambiguous": "false",
                "id": "15458"
            }
        }, {
            "@attributes": {
                "type": "4",
                "count": "2",
                "name": "kawai_sasami",
                "ambiguous": "false",
                "id": "17033"
            }
        }, {
            "@attributes": {
                "type": "4",
                "count": "21",
                "name": "felicita_(arcana_famiglia)",
                "ambiguous": "false",
                "id": "16394"
            }
        }, {
            "@attributes": {
                "type": "4",
                "count": "22",
                "name": "yukariki_ichihime",
                "ambiguous": "false",
                "id": "8582"
            }
        }, {
            "@attributes": {
                "type": "6",
                "count": "68",
                "name": "ns_eyes_105",
                "ambiguous": "false",
                "id": "5190"
            }
        }, {
            "@attributes": {
                "type": "5",
                "count": "26",
                "name": "ayase_miku",
                "ambiguous": "false",
                "id": "5540"
            }
        }, {
            "@attributes": {
                "type": "5",
                "count": "25",
                "name": "nazuna",
                "ambiguous": "false",
                "id": "4838"
            }
        }, {
            "@attributes": {
                "type": "4",
                "count": "17",
                "name": "nefertari_vivi",
                "ambiguous": "false",
                "id": "6750"
            }
        }, {
            "@attributes": {
                "type": "3",
                "count": "99",
                "name": "maid_in_angels",
                "ambiguous": "false",
                "id": "10982"
            }
        }, {
            "@attributes": {
                "type": "5",
                "count": "102",
                "name": "tsugunaga_momoko",
                "ambiguous": "false",
                "id": "13034"
            }
        }, {
            "@attributes": {
                "type": "6",
                "count": "33",
                "name": "two_658",
                "ambiguous": "false",
                "id": "5966"
            }
        }, {
            "@attributes": {
                "type": "5",
                "count": "11",
                "name": "makihamu",
                "ambiguous": "false",
                "id": "18065"
            }
        }, {
            "@attributes": {
                "type": "5",
                "count": "15",
                "name": "momo_yayoi",
                "ambiguous": "false",
                "id": "3815"
            }
        }, {
            "@attributes": {
                "type": "5",
                "count": "1227",
                "name": "yoyo",
                "ambiguous": "false",
                "id": "14956"
            }
        }, {
            "@attributes": {
                "type": "5",
                "count": "49",
                "name": "emusuda_riria",
                "ambiguous": "false",
                "id": "10580"
            }
        }, {
            "@attributes": {
                "type": "4",
                "count": "7",
                "name": "tobisawa_misaki",
                "ambiguous": "false",
                "id": "18196"
            }
        }, {
            "@attributes": {
                "type": "4",
                "count": "34",
                "name": "rydia",
                "ambiguous": "false",
                "id": "11198"
            }
        }, {
            "@attributes": {
                "type": "5",
                "count": "36",
                "name": "narutani_yaiba",
                "ambiguous": "false",
                "id": "13713"
            }
        }, {
            "@attributes": {
                "type": "0",
                "count": "1677",
                "name": "teddy",
                "ambiguous": "false",
                "id": "2073"
            }
        }, {
            "@attributes": {
                "type": "6",
                "count": "30",
                "name": "taboo-love_bondage_011",
                "ambiguous": "false",
                "id": "12482"
            }
        }, {
            "@attributes": {
                "type": "3",
                "count": "11",
                "name": "futari_wa_precure",
                "ambiguous": "false",
                "id": "8602"
            }
        }, {
            "@attributes": {
                "type": "6",
                "count": "214",
                "name": "the_midnight_circus",
                "ambiguous": "false",
                "id": "9873"
            }
        }, {
            "@attributes": {
                "type": "6",
                "count": "100",
                "name": "rq-star_205",
                "ambiguous": "false",
                "id": "8685"
            }
        }, {
            "@attributes": {
                "type": "6",
                "count": "30",
                "name": "pride_joy",
                "ambiguous": "false",
                "id": "5834"
            }
        }, {
            "@attributes": {
                "type": "6",
                "count": "100",
                "name": "ys_web_513",
                "ambiguous": "false",
                "id": "17678"
            }
        }, {
            "@attributes": {
                "type": "5",
                "count": "30",
                "name": "ishibashi_nami",
                "ambiguous": "false",
                "id": "6561"
            }
        }, {
            "@attributes": {
                "type": "3",
                "count": "12",
                "name": "mahou_shoujo_taisen",
                "ambiguous": "false",
                "id": "18772"
            }
        }, {
            "@attributes": {
                "type": "5",
                "count": "7",
                "name": "ico",
                "ambiguous": "false",
                "id": "16425"
            }
        }, {
            "@attributes": {
                "type": "6",
                "count": "111",
                "name": "ys_web_061",
                "ambiguous": "false",
                "id": "4195"
            }
        }, {
            "@attributes": {
                "type": "0",
                "count": "142",
                "name": "bike_shorts",
                "ambiguous": "false",
                "id": "2382"
            }
        }, {
            "@attributes": {
                "type": "5",
                "count": "8",
                "name": "suako",
                "ambiguous": "false",
                "id": "16222"
            }
        }, {
            "@attributes": {
                "type": "4",
                "count": "7",
                "name": "kurashima_chiyuri",
                "ambiguous": "false",
                "id": "14983"
            }
        }, {
            "@attributes": {
                "type": "0",
                "count": "164",
                "name": "office_lady",
                "ambiguous": "false",
                "id": "519"
            }
        }, {
            "@attributes": {
                "type": "3",
                "count": "61",
                "name": "kara_no_kyokai",
                "ambiguous": "false",
                "id": "10702"
            }
        }, {
            "@attributes": {
                "type": "5",
                "count": "47",
                "name": "keishi",
                "ambiguous": "false",
                "id": "13883"
            }
        }, {
            "@attributes": {
                "type": "3",
                "count": "1570",
                "name": "vampire_(game)",
                "ambiguous": "false",
                "id": "749"
            }
        }, {
            "@attributes": {
                "type": "0",
                "count": "57",
                "name": "hair_bows",
                "ambiguous": "false",
                "id": "15077"
            }
        }, {
            "@attributes": {
                "type": "4",
                "count": "37",
                "name": "laura_bodewig",
                "ambiguous": "false",
                "id": "12655"
            }
        }, {
            "@attributes": {
                "type": "5",
                "count": "19",
                "name": "mitsu_usagi",
                "ambiguous": "false",
                "id": "19726"
            }
        }, {
            "@attributes": {
                "type": "6",
                "count": "30",
                "name": "taboo-love_bondage_020",
                "ambiguous": "false",
                "id": "12355"
            }
        }, {
            "@attributes": {
                "type": "5",
                "count": "95",
                "name": "kato_sayaka",
                "ambiguous": "false",
                "id": "6962"
            }
        }, {
            "@attributes": {
                "type": "5",
                "count": "80",
                "name": "kawai_yui",
                "ambiguous": "false",
                "id": "9593"
            }
        }, {
            "@attributes": {
                "type": "5",
                "count": "83",
                "name": "atori_himeko",
                "ambiguous": "false",
                "id": "16103"
            }
        }, {
            "@attributes": {
                "type": "4",
                "count": "21",
                "name": "pace_(arcana_famiglia)",
                "ambiguous": "false",
                "id": "16392"
            }
        }, {
            "@attributes": {
                "type": "5",
                "count": "40",
                "name": "tsunashima_erika",
                "ambiguous": "false",
                "id": "13579"
            }
        }, {
            "@attributes": {
                "type": "4",
                "count": "112",
                "name": "furukawa_nagisa",
                "ambiguous": "false",
                "id": "2869"
            }
        }, {
            "@attributes": {
                "type": "0",
                "count": "138",
                "name": "racing_uniform",
                "ambiguous": "false",
                "id": "2564"
            }
        }, {
            "@attributes": {
                "type": "5",
                "count": "32",
                "name": "yapa",
                "ambiguous": "false",
                "id": "11274"
            }
        }, {
            "@attributes": {
                "type": "5",
                "count": "45",
                "name": "jessica",
                "ambiguous": "false",
                "id": "17102"
            }
        }, {
            "@attributes": {
                "type": "5",
                "count": "50",
                "name": "ren_(iii)",
                "ambiguous": "false",
                "id": "10804"
            }
        }, {
            "@attributes": {
                "type": "6",
                "count": "21",
                "name": "shooting_star",
                "ambiguous": "false",
                "id": "17399"
            }
        }, {
            "@attributes": {
                "type": "5",
                "count": "18",
                "name": "saaya",
                "ambiguous": "false",
                "id": "6488"
            }
        }, {
            "@attributes": {
                "type": "5",
                "count": "7",
                "name": "aomura_yaya",
                "ambiguous": "false",
                "id": "15012"
            }
        }, {
            "@attributes": {
                "type": "6",
                "count": "95",
                "name": "dgc_0704",
                "ambiguous": "false",
                "id": "9196"
            }
        }, {
            "@attributes": {
                "type": "5",
                "count": "40",
                "name": "ayame_mio",
                "ambiguous": "false",
                "id": "11568"
            }
        }, {
            "@attributes": {
                "type": "0",
                "count": "47",
                "name": "christmas_lights",
                "ambiguous": "false",
                "id": "2616"
            }
        }, {
            "@attributes": {
                "type": "3",
                "count": "67",
                "name": "otomedius",
                "ambiguous": "false",
                "id": "5918"
            }
        }, {
            "@attributes": {
                "type": "0",
                "count": "870",
                "name": "ear_muffs",
                "ambiguous": "false",
                "id": "4314"
            }
        }, {
            "@attributes": {
                "type": "5",
                "count": "14",
                "name": "kudo_aya",
                "ambiguous": "false",
                "id": "17791"
            }
        }, {
            "@attributes": {
                "type": "5",
                "count": "2",
                "name": "nananmo",
                "ambiguous": "false",
                "id": "16303"
            }
        }, {
            "@attributes": {
                "type": "5",
                "count": "30",
                "name": "kahara_karin",
                "ambiguous": "false",
                "id": "10664"
            }
        }, {
            "@attributes": {
                "type": "5",
                "count": "16",
                "name": "satsuki_usagi",
                "ambiguous": "false",
                "id": "14475"
            }
        }, {
            "@attributes": {
                "type": "5",
                "count": "11",
                "name": "sena",
                "ambiguous": "false",
                "id": "1766"
            }
        }, {
            "@attributes": {
                "type": "0",
                "count": "2",
                "name": "sensible_shoes",
                "ambiguous": "false",
                "id": "1586"
            }
        }, {
            "@attributes": {
                "type": "5",
                "count": "257",
                "name": "nikita_yurika",
                "ambiguous": "false",
                "id": "14231"
            }
        }, {
            "@attributes": {
                "type": "6",
                "count": "80",
                "name": "rq-star_753",
                "ambiguous": "false",
                "id": "18448"
            }
        }, {
            "@attributes": {
                "type": "4",
                "count": "19",
                "name": "saenoki_naho",
                "ambiguous": "false",
                "id": "11424"
            }
        }, {
            "@attributes": {
                "type": "4",
                "count": "52",
                "name": "enma_ai",
                "ambiguous": "false",
                "id": "1593"
            }
        }, {
            "@attributes": {
                "type": "6",
                "count": "80",
                "name": "4k-star_305",
                "ambiguous": "false",
                "id": "20048"
            }
        }, {
            "@attributes": {
                "type": "0",
                "count": "1",
                "name": "cass",
                "ambiguous": "false",
                "id": "17789"
            }
        }]
    }
};

console.log(data);
console.log(Grabber.typedXML(data));
</script>
